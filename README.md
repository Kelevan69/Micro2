# Решение домашнего задания по микросервисной архитектуре

## Задача 1: Обеспечение разработки

### Требования
- облачная система;
- система контроля версий Git;
- репозиторий на каждый сервис;
- запуск сборки по событию из системы контроля версий;
- запуск сборки по кнопке с указанием параметров;
- возможность привязать настройки к каждой сборке;
- возможность создания шаблонов для различных конфигураций сборок;
- возможность безопасного хранения секретных данных (пароли, ключи доступа);
- несколько конфигураций для сборки из одного репозитория;
- кастомные шаги при сборке;
- собственные докер-образы для сборки проектов;
- возможность развернуть агентов сборки на собственных серверах;
- возможность параллельного запуска нескольких сборок;
- возможность параллельного запуска тестов.
  
### Решение
- **GitLab**: Облачная система, предоставляющая систему контроля версий Git и возможность создания отдельных репозиториев для каждого сервиса.
- **GitLab CI/CD**: Интегрированная система непрерывной интеграции и доставки, которая позволяет:
1. Запускать сборки по событиям из системы контроля версий (например, push или merge request).
2. Запускать сборки вручную с указанием параметров.
3. Настраивать параметры для каждой сборки.
4. Создавать шаблоны для различных конфигураций сборок.
5. Безопасно хранить секретные данные с помощью переменных CI/CD, защищенных и маскированных.
6. Настраивать несколько конфигураций для сборки из одного репозитория с помощью различных job и stage.
7. Добавлять кастомные шаги при сборке, определяя их в .gitlab-ci.yml.
8. Использовать собственные Docker-образы для сборки проектов, указывая их в качестве образа для job.
9. Развертывать агентов сборки (GitLab Runner) на собственных серверах для выполнения job.
10 Параллельно запускать несколько сборок и тестов, определяя параллельные job и используя параметр parallel.

### Обоснование выбора
GitLab предоставляет комплексное решение, объединяющее систему контроля версий и мощные возможности CI/CD. Его гибкость и расширяемость позволяют настроить процесс разработки в соответствии с указанными требованиями, обеспечивая эффективную и безопасную разработку микросервисной архитектуры.

---

## Задача 2: Логи

### Требования
- сбор логов в центральное хранилище со всех хостов, обслуживающих систему;
- минимальные требования к приложениям, сбор логов из stdout;
- гарантированная доставка логов до центрального хранилища;
- обеспечение поиска и фильтрации по записям логов;
- обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
- возможность дать ссылку на сохранённый поиск по записям логов.

### Решение
Для удовлетворения указанных требований можно использовать стек ELK (Elasticsearch, Logstash, Kibana) в сочетании с Filebeat:
- **Filebeat**: Легковесный агент для отправки логов, который собирает логи из stdout приложений и отправляет их в Logstash или напрямую в Elasticsearch.
- **Logstash**: Сервис для обработки и передачи логов, который получает данные от Filebeat, выполняет необходимую фильтрацию и преобразование, а затем отправляет их в Elasticsearch.
- **Elasticsearch**: Мощная поисковая и аналитическая система, которая хранит и индексирует логи, обеспечивая быстрый поиск и фильтрацию.
- **Kibana**: Веб-интерфейс для визуализации данных из Elasticsearch, предоставляющий возможности поиска, фильтрации и создания дашбордов.

### Обоснование выбора
Стек ELK является де-факто стандартом для сбора и анализа логов в микросервисных архитектурах. Filebeat обеспечивает минимальное влияние на производительность приложений, собирая логи из stdout. Logstash и Elasticsearch гарантируют надежную доставку и хранение логов, а Kibana предоставляет мощный и интуитивно понятный интерфейс для поиска, фильтрации и визуализации логов.

---

## Задача 3: Мониторинг

### Требования
- сбор метрик со всех хостов, обслуживающих систему;
- сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
- сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
- сбор метрик, специфичных для каждого сервиса;
- пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
- пользовательский интерфейс с возможностью настраивать различные панели для отслеживания состояния системы.

### Решение
- **Prometheus**: Собирает метрики с сервисов через HTTP (pull-модель). Позволяет задавать пороговые значения и отправлять уведомления через Alertmanager. Поддерживает временные ряды для анализа данных.

- **Grafana**: Визуализирует метрики в виде графиков и дашбордов. Позволяет легко настраивать представление данных. Интегрируется с Prometheus для отображения метрик.

- **Node Exporter / cAdvisor**: Node Exporter собирает системные метрики с хостов. cAdvisor отслеживает потребление ресурсов контейнерами (CPU, RAM, дисковая активность).

### Обоснование выбора
Prometheus и Grafana — проверенные решения для мониторинга микросервисов. Они позволяют собирать данные о работе сервисов и инфраструктуры, задавать пороговые значения и оповещения, а также визуализировать данные для быстрого анализа.
Все решения соответствуют требованиям облачности, масштабируемости и безопасности.  
